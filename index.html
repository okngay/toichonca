<!DOCTYPE html>
<html>

<head>
    <title>#TOICHONCA - VCCORP 2016</title>
    <meta charset="UTF-8">
    <script src="CanvasText-0.4.1.js"></script>
    <!--Import Google Icon Font-->
    <link href="http://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!--Import materialize.css-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.6/css/materialize.min.css">
    <link rel="stylesheet" href="hinhnen.css">
    <!--Let browser know website is optimized for mobile-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" type="text/css" href="sweetalert.css">
</head>

<body>
    <!--Import jQuery before materialize.js-->
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.6/js/materialize.min.js"></script>
    <script src="sweetalert.js"></script>
    <nav>
        <div class="nav-wrapper blue">
            <a href="#" class="brand-logo center">#TOICHONCA - VCCORP 2016</a>
        </div>
    </nav>
    <div class="container">
        <div class="row">
            <div class="col s12 m6">
                <div class="card  waves-effect waves-block waves-light hoverable">
                    <div class="">
                        <div class="input-field">
                            <span class="card-title activator grey-text text-darken-4 col s5">Tên của bạn:</span>
                            <input value="" id="ip" type="text" class="validate col s7 card-title">
                        </div>
                    </div>
                </div>
                <div class="card  waves-effect waves-block waves-light hoverable">
                    <div class="">
                        <div class="input-field">
                            <span class="card-title activator grey-text text-darken-4 col s3">Slogan: </span>
                            <input id="ip2" value="Cùng #tôi bảo vệ #cá! và #biển của chúng ta" type="text" class="validate col s9 card-title">
                        </div>
                    </div>
                </div>
                <div class="card  waves-effect waves-block waves-light hoverable" id="changehover">
                    <div class="">
                        <div class="">
                            <span class="card-title activator grey-text text-darken-4 col s4">Chọn hình:</span>
                            <select class="browser-default col s8" id="luachon">
                                <option value="1">Hình 1</option>
                                <option value="2">Hình 2</option>
                                <option value="3">Hình 3</option>
                                <option value="4">Hình 4</option>
                                <option value="5">Hình 5</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="card  waves-effect waves-block waves-light hoverable" id="taive" onclick="downloadButton()">
                    <a title="Bấm để xem hướng dẫn tải xuống">
                        <div class="card-content center green ">
                            <span class="card-title activator white-text center ">Tải xuống</span>
                        </div>
                    </a>
                </div>
                <div class="card  waves-effect waves-block waves-light hoverable" onclick="facebookShare()">
                    <div class="card-content center indigo ">
                        <span class="card-title activator white-text center ">Ủng hộ/Góp ý</span>
                    </div>
                </div>
            </div>
            <div class="col s12 m6 " id="hinhanh">
                <div class="card" style="height: 0px; cursor: pointer; " title='Bấm chuột phải chọn "Lưu hình ảnh thành..." để lưu hình!'>
                    <canvas id="myCanvas" width="480" height="500" style="border:2px solid white;">
                    </canvas>
                </div>
            </div>
        </div>
    </div>
    <img id="img" src="fish.jpg" style="display : none;" alt="The Scream" width="220" height="277">
    <script>
    $(document).ready(function() {
        $("#slogan").text($("#ip2").val());
        $("#ip").keydown(function() {
            updateText();
        });
        $("#ip").keyup(function() {
            updateText();
        });
        $("#ip2").keyup(function() {
            updateText();
        });
        $("#ip2").keydown(function() {
            updateText();
        });
        updateText();
    });

    $("body").mousemove(function(event) {
        if ($("#luachon").val() == 1) {
            document.getElementById('img').src = "fish.jpg";
        }
        if ($("#luachon").val() == 2) {
            document.getElementById('img').src = "fish2.jpg";
        }
        if ($("#luachon").val() == 3) {
            document.getElementById('img').src = "fish3.jpg";
        }
        if ($("#luachon").val() == 4) {
            document.getElementById('img').src = "fish4.jpg";
        }

        if ($("#luachon").val() == 5) {
            document.getElementById('img').src = "fish5.jpg";
        }
        updateText();

    });
    ///////////////////////////////////////////
    function updateText() {
        // alert('message');
        var c = document.getElementById("myCanvas");
        var ctx = c.getContext("2d");

        var img = document.getElementById("img");
        ctx.drawImage(img, 0, 0, 500, 500);
        ctx.font = "40px Arial";

        if ($("#luachon").val() == 3) {
            ctx.fillStyle = "white";
        } else {
            ctx.fillStyle = "black";
        }
        ctx.fillText('#' + $("#ip").val().toUpperCase() + "", 160, 480);
        initCanvasText();

    }

    function myCanvas() {
        var c = document.getElementById("myCanvas");
        var ctx = c.getContext("2d");
        var img = document.getElementById("img");
        ctx.drawImage(img, 0, 0, 500, 500);
        ctx.font = "40px Arial";
        ctx.fillText('#TÔI' + " ", 160, 480);
        var canvas = document.getElementById("myCanvas");

    }
    myCanvas();

    // Definition of global vars
    var Canvas, Context;
    // Creation of the new CanvasText instance.
    var CT = new CanvasText();
    // Our canvas element must be loaded before the usage of CanvasText.
    window.onload = initCanvasText;

    function initCanvasText() {
        Canvas = document.getElementById("myCanvas");
        Context = Canvas.getContext("2d");
        // Once window is loaded we set the configuration and the default styles.
        var colorTXT = '#000';
        if ($("#luachon").val() == 5 || $("#luachon").val() == 3) {
            colorTXT = 'white';
        }
        CT.config({
            canvas: Canvas,
            context: Context,
            fontFamily: "Verdana",
            fontSize: "40px",
            fontWeight: "normal",
            fontColor: colorTXT,
            lineHeight: "45"
        });
        /* Write the text (with or without styles) */

        var str = $("#ip2").val();
        var txt = str;
        txt = str.replace(/#cá|#biển|#tôi|#hãy/gi, function myFunction(x) {
            if (x == "#tôi") {

                if ($("#luachon").val() == 3) {
                    return '<style="font-weight:bold;color:#ffd700;font-size:40px">TÔI</style>';
                } else {
                    return '<style="font-weight:bold;color:#f79744;font-size:40px">TÔI</style>';
                }

            }
            if (x == "#cá") {
                return '<style="font-weight:bold;color:#ff1010;font-size:40px">CÁ</style>';
            }

            if (x == "#biển") {
                return '<style="font-weight:bold;color:#00F;font-size:40px">BIỂN</style>';
            }

            if (x == "#hãy") {
                return '<style="font-weight:bold;color:#fd9901;font-size:40px">HÃY</style>';
            }

        });
        var text = txt;
        /**
         * Draw the text without automatic line break.
         */
        CT.drawText({
            text: text,
            x: 5,
            y: 70,
            boxWidth: 480
        });


    }

    function downloadButton() {
        swal('Hướng dẫn', 'Di chuyển chuột đến hình ảnh sau đó bấm chuột phải chọn "Lưu hình ảnh thành..." để lưu hình!', "info");
    }


    function facebookShare() {
        swal('Liên hệ Email: okngayvn@gmail.com', "Cảm ơn bạn đã quan tâm, chúc bạn một ngày tốt lành", 'success');
    }
    </script>
</body>

</html>
